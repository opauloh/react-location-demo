{"version":3,"file":"react-location.development.js","sources":["../../../node_modules/@babel/runtime/helpers/esm/extends.js","../src/index.tsx"],"sourcesContent":["export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import * as React from 'react'\n\nimport {\n  createHashHistory,\n  createBrowserHistory,\n  createMemoryHistory,\n  BrowserHistory,\n  MemoryHistory,\n  History,\n  HashHistory,\n} from 'history'\n\nexport { createHashHistory, createBrowserHistory, createMemoryHistory }\n\n// Types\n\ntype Timeout = ReturnType<typeof setTimeout>\n\ntype Maybe<T, TUnknown> = T extends {} ? T : TUnknown\n\nexport type DefaultGenerics = {\n  LoaderData: LoaderData<unknown>\n  Params: Params<string>\n  Search: Search<unknown>\n  RouteMeta: RouteMeta<unknown>\n}\n\nexport type PartialGenerics = Partial<DefaultGenerics>\n\nexport type MakeGenerics<TGenerics extends PartialGenerics> = TGenerics\n\nexport type Search<T> = Record<string, T>\nexport type Params<T> = Record<string, T>\nexport type LoaderData<T> = Record<string, T>\nexport type RouteMeta<T> = Record<string, T>\n\nexport type UseGeneric<\n  TGenerics extends PartialGenerics,\n  TGeneric extends keyof PartialGenerics,\n> = TGeneric extends 'LoaderData' | 'Search'\n  ? Partial<Maybe<TGenerics[TGeneric], DefaultGenerics[TGeneric]>>\n  : Maybe<TGenerics[TGeneric], DefaultGenerics[TGeneric]>\n\nexport type ReactLocationOptions = {\n  // The history object to be used internally by react-location\n  // A history will be created automatically if not provided.\n  history?: BrowserHistory | MemoryHistory | HashHistory\n  stringifySearch?: SearchSerializer\n  parseSearch?: SearchParser\n}\n\ntype SearchSerializer = (searchObj: Record<string, any>) => string\ntype SearchParser = (searchStr: string) => Record<string, any>\n\nexport type Updater<TResult> = TResult | ((prev?: TResult) => TResult)\n\nexport type Location<TGenerics extends PartialGenerics = DefaultGenerics> = {\n  href: string\n  pathname: string\n  search: UseGeneric<TGenerics, 'Search'>\n  searchStr: string\n  hash: string\n  key?: string\n  // nextAction?: 'push' | 'replace'\n}\n\nexport type Route<TGenerics extends PartialGenerics = DefaultGenerics> =\n  // Route Loaders (see below) can be inline on the route, or resolved async\n  // via the `import` property\n  RouteLoaders<TGenerics> & {\n    // The path to match (relative to the nearest parent `Route` component or root basepath)\n    path?: string\n    // Either (1) an object that will be used to shallowly match the current location's search or (2) A function that receives the current search params and can return truthy if they are matched.\n    search?: SearchPredicate<UseGeneric<TGenerics, 'Search'>>\n    // The duration to wait during `loader` execution before showing the `pendingElement`\n    pendingMs?: number\n    // _If the `pendingElement` is shown_, the minimum duration for which it will be visible.\n    pendingMinMs?: number\n    // Search filters can be used to rewrite, persist, default and manipulate search params for link that\n    // point to their routes or child routes. See the \"basic\" example to see them in action.\n    searchFilters?: SearchFilter<TGenerics>[]\n    // An array of child routes\n    children?: Route<TGenerics>[]\n  } & {\n    // If `import` is defined, this route can resolve its elements and loaders in a single asynchronous call\n    // This is particularly useful for code-splitting or module federation\n    import?: (opts: {\n      params: UseGeneric<TGenerics, 'Params'>\n      search: UseGeneric<TGenerics, 'Search'>\n    }) => Promise<RouteLoaders<TGenerics>>\n  }\n\nexport type RouteLoaders<TGenerics> = {\n  // The content to be rendered when the route is matched. If no element is provided, defaults to `<Outlet />`\n  element?: SyncOrAsyncElement<TGenerics>\n  // The content to be rendered when `loader` encounters an error\n  errorElement?: SyncOrAsyncElement<TGenerics>\n  // The content to be rendered when the duration of `loader` execution surpasses the `pendingMs` duration\n  pendingElement?: SyncOrAsyncElement<TGenerics>\n  // An asynchronous function responsible for preparing or fetching data for the route before it is rendered\n  loader?: LoaderFn<TGenerics>\n  // An integer of milliseconds representing how long data should be cached for the route\n  loaderMaxAge?: number\n  // Similar to React's useEffect hook, this function is called\n  // when moving from an inactive state to an active one. Likewise, when moving from\n  // an active to an inactive state, the return function (if provided) is called.\n  onMatch?: (\n    match: RouteMatch<TGenerics>,\n  ) => void | undefined | ((match: RouteMatch<TGenerics>) => void)\n  // This function is called when the route remains active from one transition to the next.\n  onTransition?: (match: RouteMatch<TGenerics>) => void\n  // An object of whatever you want! This object is accessible anywhere matches are.\n  meta?: UseGeneric<TGenerics, 'RouteMeta'>\n}\n\nexport type SearchFilter<TGenerics> = (\n  prev: UseGeneric<TGenerics, 'Search'>,\n  next: UseGeneric<TGenerics, 'Search'>,\n) => UseGeneric<TGenerics, 'Search'>\n\nexport type MatchLocation<TGenerics extends PartialGenerics = DefaultGenerics> =\n  {\n    to?: string | number | null\n    search?: SearchPredicate<UseGeneric<TGenerics, 'Search'>>\n    fuzzy?: boolean\n  }\n\nexport type SearchPredicate<TSearch> = (search: TSearch) => any\n\nexport type SyncOrAsyncElement<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = React.ReactNode | AsyncElement<TGenerics>\n\nexport type AsyncElement<TGenerics extends PartialGenerics = DefaultGenerics> =\n  (opts: {\n    params: UseGeneric<TGenerics, 'Params'>\n  }) => Promise<React.ReactNode>\n\nexport type UnloadedMatch<TGenerics extends PartialGenerics = DefaultGenerics> =\n  {\n    id: string\n    route: Route<TGenerics>\n    routeIndex: number\n    pathname: string\n    params: UseGeneric<TGenerics, 'Params'>\n    search: UseGeneric<TGenerics, 'Search'>\n  }\n\nexport type LoaderFn<TGenerics extends PartialGenerics = DefaultGenerics> = (\n  routeMatch: RouteMatch<TGenerics>,\n  opts: LoaderFnOptions<TGenerics>,\n) => PromiseLike<UseGeneric<TGenerics, 'LoaderData'>>\n\nexport type LoaderFnOptions<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = {\n  parentMatch?: RouteMatch<TGenerics>\n  dispatch: (event: LoaderDispatchEvent<TGenerics>) => void\n}\n\ntype PromiseLike<T> = Promise<T> | T\n\nexport type ListenerFn = () => void\n\nexport type Segment = {\n  type: 'pathname' | 'param' | 'wildcard'\n  value: string\n}\n\nexport type RouterProps<TGenerics extends PartialGenerics = DefaultGenerics> = {\n  // Children will default to `<Outlet />` if not provided\n  children?: React.ReactNode\n} & RouterOptions<TGenerics>\n\nexport type RouterOptions<TGenerics> = {\n  // An array of route objects to match\n  location: ReactLocation<TGenerics>\n  routes: Route<TGenerics>[]\n  basepath?: string\n  filterRoutes?: FilterRoutesFn\n  defaultLinkPreloadMaxAge?: number\n  defaultLoaderMaxAge?: number\n  useErrorBoundary?: boolean\n  defaultElement?: SyncOrAsyncElement<TGenerics>\n  defaultErrorElement?: SyncOrAsyncElement<TGenerics>\n  defaultPendingElement?: SyncOrAsyncElement<TGenerics>\n  defaultPendingMs?: number\n  defaultPendingMinMs?: number\n  // An array of route match objects that have been both _matched_ and _loaded_. See the [SRR](#ssr) section for more details\n  initialMatches?: RouteMatch<TGenerics>[]\n}\n\nexport type BuildNextOptions<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = {\n  to?: string | number | null\n  search?: true | Updater<UseGeneric<TGenerics, 'Search'>>\n  hash?: Updater<string>\n  from?: Partial<Location<TGenerics>>\n  key?: string\n  __searchFilters?: SearchFilter<TGenerics>[]\n}\n\nexport type NavigateOptions<TGenerics> = BuildNextOptions<TGenerics> & {\n  replace?: boolean\n  fromCurrent?: boolean\n}\n\nexport type PromptProps = {\n  message: string\n  when?: boolean | any\n  children?: React.ReactNode\n}\n\nexport type LinkProps<TGenerics extends PartialGenerics = DefaultGenerics> =\n  Omit<React.AnchorHTMLAttributes<HTMLAnchorElement>, 'href' | 'children'> & {\n    // The absolute or relative destination pathname\n    to?: string | number | null\n    // The new search object or a function to update it\n    search?: true | Updater<UseGeneric<TGenerics, 'Search'>>\n    // The new has string or a function to update it\n    hash?: Updater<string>\n    // Whether to replace the current history stack instead of pushing a new one\n    replace?: boolean\n    // A function that is passed the [Location API](#location-api) and returns additional props for the `active` state of this link. These props override other props passed to the link (`style`'s are merged, `className`'s are concatenated)\n    getActiveProps?: () => Record<string, any>\n    // Defaults to `{ exact: false, includeHash: false }`\n    activeOptions?: ActiveOptions\n    // If set, will preload the linked route on hover and cache it for this many milliseconds in hopes that the user will eventually navigate there.\n    preload?: number\n    // If true, will render the link without the href attribute\n    disabled?: boolean\n    // A custom ref prop because of this: https://stackoverflow.com/questions/58469229/react-with-typescript-generics-while-using-react-forwardref/58473012\n    _ref?: React.Ref<HTMLAnchorElement>\n    // If a function is pass as a child, it will be given the `isActive` boolean to aid in further styling on the element it returns\n    children?:\n      | React.ReactNode\n      | ((state: { isActive: boolean }) => React.ReactNode)\n  }\n\ntype ActiveOptions = {\n  exact?: boolean\n  includeHash?: boolean\n}\n\nexport type LinkPropsType<TGenerics extends PartialGenerics = DefaultGenerics> =\n  LinkProps<TGenerics>\n\nexport type LoaderDispatchEvent<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> =\n  | {\n      type: 'maxAge'\n      maxAge: number\n    }\n  | {\n      type: 'loading'\n    }\n  | {\n      type: 'resolve'\n      data: UseGeneric<TGenerics, 'LoaderData'>\n    }\n  | {\n      type: 'reject'\n      error: unknown\n    }\n\nexport type LoadRouteFn<TGenerics> = (\n  next: Location<TGenerics>,\n) => MatchLoader<TGenerics>\n\nexport type TransitionState<TGenerics> = {\n  status: 'pending' | 'ready'\n  location: Location<TGenerics>\n  matches: RouteMatch<TGenerics>[]\n}\n\nexport type FilterRoutesFn = <\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(\n  routes: Route<TGenerics>[],\n) => Route<TGenerics>[]\n\nexport type RouterPropsType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = RouterProps<TGenerics>\n\nexport type RouterType<TGenerics extends PartialGenerics = DefaultGenerics> = (\n  props: RouterProps<TGenerics>,\n) => JSX.Element\n\ntype Listener<TPayload> = (payload: TPayload) => void\n\n// Source\n\nconst LocationContext = React.createContext<ReactLocation<any>>(null!)\nconst MatchesContext = React.createContext<RouteMatch<any>[]>(null!)\nconst routerContext = React.createContext<{ router: RouterInstance<any> }>(\n  null!,\n)\n\n// Detect if we're in the DOM\nconst isDOM = Boolean(\n  typeof window !== 'undefined' &&\n    window.document &&\n    window.document.createElement,\n)\n\nconst useLayoutEffect = isDOM ? React.useLayoutEffect : React.useEffect\n\n// This is the default history object if none is defined\nconst createDefaultHistory = () =>\n  isDOM ? createBrowserHistory() : createMemoryHistory()\n\nclass Subscribable<TPayload = void> {\n  listeners: Listener<TPayload>[]\n\n  constructor() {\n    this.listeners = []\n  }\n\n  subscribe(listener: Listener<TPayload>): () => void {\n    this.listeners.push(listener as Listener<TPayload>)\n\n    return () => {\n      this.listeners = this.listeners.filter((x) => x !== listener)\n    }\n  }\n\n  notify(payload: TPayload): void {\n    this.listeners.forEach((listener) => listener(payload))\n  }\n}\n\nexport class ReactLocation<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> extends Subscribable {\n  history: BrowserHistory | MemoryHistory\n  stringifySearch: SearchSerializer\n  parseSearch: SearchParser\n\n  current: Location<TGenerics>\n  destroy: () => void\n  navigateTimeout?: Timeout\n  nextAction?: 'push' | 'replace'\n\n  //\n\n  isTransitioning: boolean = false\n\n  constructor(options?: ReactLocationOptions) {\n    super()\n    this.history = options?.history || createDefaultHistory()\n    this.stringifySearch = options?.stringifySearch ?? defaultStringifySearch\n    this.parseSearch = options?.parseSearch ?? defaultParseSearch\n\n    this.current = this.parseLocation(this.history.location)\n\n    this.destroy = this.history.listen((event) => {\n      this.current = this.parseLocation(event.location, this.current)\n      this.notify()\n    })\n  }\n\n  buildNext(\n    basepath: string = '/',\n    dest: BuildNextOptions<TGenerics> = {},\n  ): Location<TGenerics> {\n    const from = {\n      ...this.current,\n      ...dest.from,\n    }\n\n    const pathname = resolvePath(basepath, from.pathname, `${dest.to ?? '.'}`)\n\n    const updatedSearch =\n      (dest.search === true\n        ? from.search\n        : functionalUpdate(dest.search, from.search)) ?? {}\n\n    const filteredSearch = dest.__searchFilters?.length\n      ? dest.__searchFilters.reduce(\n          (prev, next) => next(prev, updatedSearch),\n          from.search,\n        )\n      : updatedSearch\n\n    const search = replaceEqualDeep(from.search, filteredSearch)\n\n    const searchStr = this.stringifySearch(search)\n    let hash = functionalUpdate(dest.hash, from.hash)\n    hash = hash ? `#${hash}` : ''\n\n    return {\n      pathname,\n      search,\n      searchStr,\n      hash,\n      href: `${pathname}${searchStr}${hash}`,\n      key: dest.key,\n    }\n  }\n\n  navigate(next: Location<TGenerics>, replace?: boolean): void {\n    this.current = next\n\n    if (this.navigateTimeout) clearTimeout(this.navigateTimeout)\n\n    let nextAction: 'push' | 'replace' = 'replace'\n\n    if (!this.nextAction) {\n      nextAction = replace ? 'replace' : 'push'\n    }\n\n    if (!replace) {\n      nextAction = 'push'\n    }\n\n    this.nextAction = nextAction\n\n    this.navigateTimeout = setTimeout(() => {\n      let nextAction = this.nextAction\n      delete this.nextAction\n\n      const isSameUrl =\n        this.parseLocation(this.history.location).href === this.current.href\n\n      if (isSameUrl && !this.current.key) {\n        nextAction = 'replace'\n      }\n\n      if (nextAction === 'replace') {\n        return this.history.replace({\n          pathname: this.current.pathname,\n          hash: this.current.hash,\n          search: this.current.searchStr,\n        })\n      }\n\n      return this.history.push({\n        pathname: this.current.pathname,\n        hash: this.current.hash,\n        search: this.current.searchStr,\n      })\n    }, 16)\n  }\n\n  parseLocation(\n    location: History['location'],\n    previousLocation?: Location<TGenerics>,\n  ): Location<TGenerics> {\n    const parsedSearch = this.parseSearch(location.search)\n\n    return {\n      pathname: location.pathname,\n      searchStr: location.search,\n      search: replaceEqualDeep(previousLocation?.search, parsedSearch),\n      hash: location.hash.split('#').reverse()[0] ?? '',\n      href: `${location.pathname}${location.search}${location.hash}`,\n      key: location.key,\n    }\n  }\n}\n\nexport type MatchesProviderProps<TGenerics> = {\n  value: RouteMatch<TGenerics>[]\n  children: React.ReactNode\n}\n\nexport function MatchesProvider<TGenerics>(\n  props: MatchesProviderProps<TGenerics>,\n) {\n  return <MatchesContext.Provider {...props} />\n}\n\nexport function Router<TGenerics extends PartialGenerics = DefaultGenerics>({\n  children,\n  location,\n  ...rest\n}: RouterProps<TGenerics>) {\n  const routerRef = React.useRef<RouterInstance<TGenerics>>(null!)\n  if (!routerRef.current) {\n    routerRef.current = new RouterInstance<TGenerics>({ ...rest, location })\n  }\n  const router = routerRef.current\n\n  const [nonce, rerender] = React.useReducer(() => ({}), {})\n\n  useLayoutEffect(() => {\n    return router.subscribe(rerender)\n  }, [])\n\n  useLayoutEffect(() => {\n    return router.updateLocation(location.current).unsubscribe\n  }, [location.current.key])\n\n  const routerValue = React.useMemo(\n    () => ({\n      router,\n    }),\n    [nonce],\n  )\n\n  return (\n    <LocationContext.Provider value={location}>\n      <routerContext.Provider value={routerValue}>\n        <MatchesProvider value={[router.rootMatch, ...router.state.matches]}>\n          {children}\n        </MatchesProvider>\n      </routerContext.Provider>\n    </LocationContext.Provider>\n  )\n}\n\ntype RouterInstanceState<TGenerics> = {\n  state: TransitionState<TGenerics>\n  pending?: TransitionState<TGenerics>\n}\n\nexport class RouterInstance<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> extends Subscribable {\n  basepath: string\n  rootMatch: RouteMatch<TGenerics>\n  state: TransitionState<TGenerics>\n  pending?: TransitionState<TGenerics>\n  routes!: Route<TGenerics>[]\n  filterRoutes?: FilterRoutesFn\n  defaultLinkPreloadMaxAge?: number\n  defaultLoaderMaxAge?: number\n  useErrorBoundary?: boolean\n  defaultElement: SyncOrAsyncElement<TGenerics>\n  defaultErrorElement: SyncOrAsyncElement<TGenerics>\n  defaultPendingElement: SyncOrAsyncElement<TGenerics>\n  defaultPendingMs?: number\n  defaultPendingMinMs?: number\n\n  constructor(\n    opts: { location: ReactLocation<TGenerics> } & RouterOptions<TGenerics>,\n  ) {\n    super()\n    Object.assign(this, opts)\n\n    this.basepath = cleanPath(`/${opts.basepath ?? ''}`)\n    this.rootMatch = {\n      id: 'root',\n      params: {} as any,\n      search: {} as any,\n      routeIndex: 0,\n      pathname: this.basepath,\n      route: null!,\n      data: {},\n      isLoading: false,\n      status: 'resolved',\n    }\n\n    this.state = {\n      status: 'ready',\n      location: opts.location.current,\n      matches: opts.initialMatches ?? [],\n    }\n\n    opts.location.subscribe(() => this.notify())\n  }\n\n  setState = (\n    updater: (\n      old: RouterInstanceState<TGenerics>,\n    ) => RouterInstanceState<TGenerics>,\n  ) => {\n    const newState = updater({ state: this.state, pending: this.pending })\n    this.state = newState.state\n    this.pending = newState.pending\n    this.cleanMatchCache()\n    this.notify()\n  }\n\n  matchCache: Record<string, RouteMatch<TGenerics>> = {}\n\n  getMatchLoader = (next: Location<TGenerics>) => {\n    return new MatchLoader(this, next)\n  }\n\n  cleanMatchCache = () => {\n    const activeMatchIds = [\n      ...(this?.state.matches ?? []),\n      ...(this?.pending?.matches ?? []),\n    ].map((d) => d.id)\n\n    Object.values(this.matchCache).forEach((match) => {\n      if (!match.updatedAt) {\n        return\n      }\n\n      if (activeMatchIds.includes(match.id)) {\n        return\n      }\n\n      const age = Date.now() - (match.updatedAt ?? 0)\n\n      if (!match.maxAge || age > match.maxAge) {\n        delete this.matchCache[match.id]\n      }\n    })\n  }\n\n  updateLocation = (next: Location<TGenerics>) => {\n    let unsubscribe: () => void\n\n    const promise = new Promise<void>((resolve) => {\n      const matchLoader = this.getMatchLoader(next)\n\n      this.state.matches?.forEach((match) => {\n        match.used = true\n      })\n\n      this.setState((old) => {\n        return {\n          ...old,\n          pending: {\n            status: 'pending',\n            location: matchLoader.location,\n            matches: matchLoader.matches,\n          },\n        }\n      })\n\n      unsubscribe = matchLoader.subscribe(() => {\n        const currentMatches = this.state.matches\n\n        currentMatches\n          .filter((d) => {\n            return !matchLoader.matches.find((dd) => dd.id === d.id)\n          })\n          .forEach((d) => {\n            d.onExit?.(d)\n          })\n\n        currentMatches\n          .filter((d) => {\n            return matchLoader.matches.find((dd) => dd.id === d.id)\n          })\n          .forEach((d) => {\n            d.route.onTransition?.(d)\n          })\n\n        matchLoader.matches\n          .filter((d) => {\n            return !currentMatches.find((dd) => dd.id === d.id)\n          })\n          .forEach((d) => {\n            d.onExit = d.route.onMatch?.(d)\n          })\n\n        this.setState((old) => {\n          return {\n            ...old,\n            state: {\n              status: 'ready',\n              location: matchLoader.location,\n              matches: matchLoader.matches,\n            },\n            pending: undefined,\n          }\n        })\n\n        resolve()\n      })\n\n      matchLoader.loadData()\n      matchLoader.startPending()\n    })\n\n    return {\n      promise,\n      unsubscribe: unsubscribe!,\n    }\n  }\n}\n\nexport type UseLocationType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = () => ReactLocation<TGenerics>\n\nexport function useLocation<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): ReactLocation<TGenerics> {\n  const getIsMounted = useGetIsMounted()\n  const [, rerender] = React.useReducer((d) => d + 1, 0)\n  const instance = React.useContext(LocationContext) as ReactLocation<TGenerics>\n  warning(!!instance, 'useLocation must be used within a <ReactLocation />')\n\n  useLayoutEffect(() => {\n    return instance.subscribe(() => {\n      // Rerender all subscribers in a microtask\n      Promise.resolve().then(() => {\n        setTimeout(function renderAllLocationSubscribers() {\n          if (getIsMounted()) {\n            rerender()\n          }\n        }, 0)\n      })\n    })\n  }, [instance])\n\n  return instance\n}\n\nexport class RouteMatch<TGenerics extends PartialGenerics = DefaultGenerics> {\n  id!: string\n  route!: Route<TGenerics>\n  routeIndex!: number\n  pathname!: string\n  params!: UseGeneric<TGenerics, 'Params'>\n  search!: UseGeneric<TGenerics, 'Search'>\n  updatedAt?: number\n  element?: React.ReactNode\n  errorElement?: React.ReactNode\n  pendingElement?: React.ReactNode\n  error?: unknown\n  loaderPromise?: Promise<UseGeneric<TGenerics, 'LoaderData'>>\n  used?: boolean\n  maxAge?: number\n  matchLoader?: MatchLoader<TGenerics>\n  pendingTimeout?: Timeout\n  pendingMinPromise?: Promise<void>\n  onExit?: void | ((match: RouteMatch<TGenerics>) => void)\n\n  constructor(unloadedMatch: UnloadedMatch<TGenerics>) {\n    Object.assign(this, unloadedMatch)\n  }\n\n  status: 'pending' | 'resolved' | 'rejected' = 'pending'\n  data: UseGeneric<TGenerics, 'LoaderData'> = {}\n  isLoading: boolean = false\n\n  private notify? = (isSoft?: boolean) => {\n    this.matchLoader?.notify(isSoft)\n  }\n\n  assignMatchLoader? = (matchLoader: MatchLoader<TGenerics>) => {\n    this.matchLoader = matchLoader\n  }\n\n  startPending? = () => {\n    if (this.pendingTimeout) {\n      clearTimeout(this.pendingTimeout)\n    }\n\n    if (this.route.pendingMs) {\n      this.pendingTimeout = setTimeout(() => {\n        this.notify?.()\n        if (typeof this.route.pendingMinMs !== 'undefined') {\n          this.pendingMinPromise = new Promise((r) =>\n            setTimeout(r, this.route.pendingMinMs),\n          )\n        }\n      }, this.route.pendingMs)\n    }\n  }\n\n  load? = (opts: {\n    maxAge?: number\n    parentMatch?: RouteMatch<TGenerics>\n    router: RouterInstance<TGenerics>\n  }) => {\n    this.maxAge =\n      opts.maxAge ?? this.route.loaderMaxAge ?? opts.router.defaultLoaderMaxAge\n\n    if (this.loaderPromise) {\n      return\n    }\n\n    const importer = this.route.import\n\n    // First, run any importers\n    this.loaderPromise = (\n      !importer\n        ? Promise.resolve()\n        : importer({ params: this.params, search: this.search }).then(\n            (imported) => {\n              this.route = {\n                ...this.route,\n                ...imported,\n              }\n            },\n          )\n    )\n      // then run all element and data loaders in parallel\n      .then(() => {\n        const elementPromises: Promise<void>[] = []\n\n        // For each element type, potentially load it asynchronously\n        const elementTypes = [\n          'element',\n          'errorElement',\n          'pendingElement',\n        ] as const\n\n        elementTypes.forEach((type) => {\n          const routeElement = this.route[type]\n\n          if (this[type]) {\n            return\n          }\n\n          if (typeof routeElement === 'function') {\n            elementPromises.push(\n              (routeElement as AsyncElement)(this).then((res) => {\n                this[type] = res\n              }),\n            )\n          } else {\n            this[type] = this.route[type]\n          }\n        })\n\n        const loader = this.route.loader\n\n        const dataPromise = !loader\n          ? Promise.resolve().then(() => {\n              this.status = 'resolved'\n            })\n          : new Promise(async (resolveLoader, rejectLoader) => {\n              let pendingTimeout: Timeout\n\n              const resolve = (data: any) => {\n                this.status = 'resolved'\n                this.data = data\n                this.error = undefined\n              }\n\n              const reject = (err: any) => {\n                console.error(err)\n                this.status = 'rejected'\n                this.error = err\n                rejectLoader(err)\n              }\n\n              const finish = () => {\n                this.isLoading = false\n                this.startPending = undefined\n                clearTimeout(pendingTimeout)\n                resolveLoader(this.data)\n              }\n\n              try {\n                this.isLoading = true\n\n                resolve(\n                  await loader(this, {\n                    parentMatch: opts.parentMatch,\n                    dispatch: async (event) => {\n                      if (event.type === 'resolve') {\n                        resolve(event.data)\n                      } else if (event.type === 'reject') {\n                        reject(event.error)\n                      } else if (event.type === 'loading') {\n                        this.isLoading = true\n                      } else if (event.type === 'maxAge') {\n                        this.maxAge = event.maxAge\n                      }\n\n                      this.updatedAt = Date.now()\n\n                      this.notify?.(true)\n                    },\n                  }),\n                )\n                await this.pendingMinPromise\n                finish()\n              } catch (err) {\n                reject(err)\n                finish()\n              }\n            })\n\n        return Promise.all([...elementPromises, dataPromise]).then(() => {\n          this.updatedAt = Date.now()\n        })\n      })\n      .then(() => {\n        return this.data\n      })\n  }\n}\n\nclass MatchLoader<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> extends Subscribable<undefined | boolean> {\n  router: RouterInstance<TGenerics>\n  location: Location<TGenerics>\n  matches: RouteMatch<TGenerics>[]\n  prepPromise?: Promise<void>\n  matchPromise?: Promise<UnloadedMatch<TGenerics>[]>\n  firstRenderPromises?: Promise<any>[]\n\n  constructor(\n    router: RouterInstance<TGenerics>,\n    nextLocation: Location<TGenerics>,\n  ) {\n    super()\n    this.router = router\n    this.location = nextLocation\n    this.matches = []\n\n    this.loadMatches()\n  }\n\n  status: 'pending' | 'resolved' = 'pending'\n\n  preNotify = (isSoft?: boolean) => {\n    if (this.status === 'pending' && isSoft) {\n      return\n    }\n\n    this.status = 'resolved'\n\n    this.matches?.forEach((match, index) => {\n      const parentMatch = this.matches?.[index - 1]\n\n      match.data = {\n        ...(parentMatch?.data ?? ({} as any)),\n        ...match.data,\n      }\n    })\n\n    this.notify(false)\n  }\n\n  private loadMatches = () => {\n    const unloadedMatches = matchRoutes(this.router, this.location)\n\n    this.matches = unloadedMatches?.map(\n      (unloadedMatch): RouteMatch<TGenerics> => {\n        if (!this.router.matchCache[unloadedMatch.id]) {\n          this.router.matchCache[unloadedMatch.id] = new RouteMatch(\n            unloadedMatch,\n          )\n        }\n\n        return this.router.matchCache[unloadedMatch.id]!\n      },\n    )\n  }\n\n  loadData = async ({ maxAge }: { maxAge?: number } = {}) => {\n    this.loadMatches()\n    this.router.cleanMatchCache()\n\n    if (!this.matches?.length) {\n      this.preNotify()\n      return\n    }\n\n    this.firstRenderPromises = []\n\n    this.matches.forEach((match, index) => {\n      const parentMatch = this.matches?.[index - 1]\n      match.assignMatchLoader?.(this)\n      match.load?.({ maxAge, parentMatch, router: this.router })\n      this.firstRenderPromises?.push(match.loaderPromise!)\n    })\n\n    return await Promise.all(this.firstRenderPromises).then(() => {\n      this.preNotify()\n      return this.matches\n    })\n  }\n\n  load = async ({ maxAge }: { maxAge?: number } = {}) => {\n    this.loadMatches()\n    return await this.loadData({ maxAge })\n  }\n\n  startPending = async () => {\n    this.matches.forEach((match) => match.startPending?.())\n  }\n}\n\nexport type UseRouterType<TGenerics extends PartialGenerics = DefaultGenerics> =\n  () => RouterInstance<TGenerics>\n\nexport function useRouter<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): RouterInstance<TGenerics> {\n  const value = React.useContext(routerContext)\n  if (!value) {\n    warning(true, 'You are trying to use useRouter() outside of ReactLocation!')\n    throw new Error()\n  }\n\n  return value.router as RouterInstance<TGenerics>\n}\n\nexport interface MatchRoutesOptions<TGenerics> {\n  filterRoutes?: FilterRoutesFn\n  defaultPendingMs?: number\n  defaultPendingMinMs?: number\n  defaultElement?: SyncOrAsyncElement<TGenerics>\n  defaultErrorElement?: SyncOrAsyncElement<TGenerics>\n  defaultPendingElement?: SyncOrAsyncElement<TGenerics>\n}\n\nexport type MatchRoutesType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = (\n  router: RouterInstance<TGenerics>[],\n  currentLocation: Location<TGenerics>,\n) => Promise<UnloadedMatch<TGenerics>[]>\n\nexport function matchRoutes<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(\n  router: RouterInstance<TGenerics>,\n  currentLocation: Location<TGenerics>,\n): UnloadedMatch<TGenerics>[] {\n  if (!router.routes?.length) {\n    return []\n  }\n\n  const matches: UnloadedMatch<TGenerics>[] = []\n\n  const recurse = async (\n    routes: Route<TGenerics>[],\n    parentMatch: UnloadedMatch<TGenerics>,\n  ): Promise<void> => {\n    let { pathname, params } = parentMatch\n    const filteredRoutes = router?.filterRoutes\n      ? router?.filterRoutes(routes)\n      : routes\n\n    let routeIndex: number = -1\n\n    const originalRoute = filteredRoutes.find((route, index) => {\n      const fullRoutePathName = joinPaths([pathname, route.path])\n\n      const fuzzy = !!(route.path !== '/' || route.children?.length)\n\n      const matchParams = matchRoute(currentLocation, {\n        to: fullRoutePathName,\n        search: route.search,\n        fuzzy,\n      })\n\n      if (matchParams) {\n        routeIndex = index\n        params = {\n          ...params,\n          ...matchParams,\n        }\n      }\n\n      return !!matchParams\n    })\n\n    if (!originalRoute) {\n      return\n    }\n\n    const interpolatedPathSegments = parsePathname(originalRoute.path)\n\n    const interpolatedPath = joinPaths(\n      interpolatedPathSegments.map((segment) => {\n        if (segment.value === '*') {\n          return ''\n        }\n\n        if (segment.type === 'param') {\n          return params![segment.value.substring(1)] ?? ''\n        }\n\n        return segment.value\n      }),\n    )\n\n    pathname = joinPaths([pathname, interpolatedPath])\n\n    const id = joinPaths([\n      parentMatch.id === 'root' ? '' : parentMatch.id,\n      `${interpolatedPath}-${routeIndex.toString()}`,\n    ])\n\n    const match: UnloadedMatch<TGenerics> = {\n      id,\n      route: {\n        ...originalRoute,\n        pendingMs: originalRoute.pendingMs ?? router?.defaultPendingMs,\n        pendingMinMs: originalRoute.pendingMinMs ?? router?.defaultPendingMinMs,\n      },\n      routeIndex,\n      params,\n      pathname,\n      search: currentLocation.search,\n    }\n\n    matches.push(match)\n\n    if (originalRoute.children?.length) {\n      recurse(originalRoute.children, match)\n    }\n  }\n\n  recurse(router.routes, router.rootMatch)\n\n  return matches\n}\n\nexport type UseLoadRouteType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = (routes?: Route<TGenerics>[]) => void\n\nexport function useLoadRoute<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>() {\n  const location = useLocation<TGenerics>()\n  const match = useMatch<TGenerics>()\n  const router = useRouter<TGenerics>()\n  const buildNext = useBuildNext<TGenerics>()\n\n  return useLatestCallback(\n    async (\n      navigate: NavigateOptions<TGenerics> = location.current,\n      opts?: { maxAge?: number },\n    ) => {\n      const next = buildNext({\n        ...navigate,\n        from: navigate.from ?? { pathname: match.pathname },\n      })\n\n      const matchLoader = router.getMatchLoader(next)\n\n      return await matchLoader.load(opts)\n    },\n  )\n}\n\nexport type UseMatchesType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = () => RouteMatch<TGenerics>[]\n\nexport function useParentMatches<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): RouteMatch<TGenerics>[] {\n  const router = useRouter<TGenerics>()\n  const match = useMatch()\n\n  const matches = router.state.matches\n\n  return matches.slice(0, matches.findIndex((d) => d.id === match.id) - 1)\n}\n\nexport function useMatches<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): RouteMatch<TGenerics>[] {\n  return React.useContext(MatchesContext)\n}\n\nexport type UseMatchType<TGenerics extends PartialGenerics = DefaultGenerics> =\n  () => RouteMatch<TGenerics>\n\nexport function useMatch<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): RouteMatch<TGenerics> {\n  return useMatches<TGenerics>()?.[0]!\n}\n\nexport type UseNavigateType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = (options: NavigateOptions<TGenerics>) => void\n\nexport function useNavigate<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>() {\n  const location = useLocation<TGenerics>()\n  const match = useMatch<TGenerics>()\n  const buildNext = useBuildNext<TGenerics>()\n\n  function navigate({\n    search,\n    hash,\n    replace,\n    from,\n    to,\n    fromCurrent,\n  }: NavigateOptions<TGenerics> & {\n    replace?: boolean\n  }) {\n    fromCurrent = fromCurrent ?? typeof to === 'undefined'\n\n    const next = buildNext({\n      to,\n      search,\n      hash,\n      from: fromCurrent\n        ? location.current\n        : from ?? { pathname: match.pathname },\n    })\n\n    location.navigate(next, replace)\n  }\n\n  return useLatestCallback(navigate)\n}\n\nexport type NavigateType<TGenerics extends PartialGenerics = DefaultGenerics> =\n  (options: NavigateOptions<TGenerics>) => null\n\nexport function Navigate<TGenerics extends PartialGenerics = DefaultGenerics>(\n  options: NavigateOptions<TGenerics>,\n) {\n  let navigate = useNavigate<TGenerics>()\n\n  useLayoutEffect(() => {\n    navigate(options)\n  }, [navigate])\n\n  return null\n}\n\nfunction useBuildNext<TGenerics>() {\n  const location = useLocation<TGenerics>()\n  const router = useRouter<TGenerics>()\n\n  const buildNext = (opts: BuildNextOptions<TGenerics>) => {\n    const next = location.buildNext(router.basepath, opts)\n\n    const matches = matchRoutes<TGenerics>(router, next)\n\n    const __searchFilters = matches\n      .map((match) => match.route.searchFilters ?? [])\n      .flat()\n      .filter(Boolean)\n\n    return location.buildNext(router.basepath, { ...opts, __searchFilters })\n  }\n\n  return useLatestCallback(buildNext)\n}\n\nexport type LinkType<TGenerics extends PartialGenerics = DefaultGenerics> = (\n  props: LinkProps<TGenerics>,\n) => JSX.Element\n\nexport const Link = function Link<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>({\n  to = '.',\n  search,\n  hash,\n  children,\n  target,\n  style = {},\n  replace,\n  onClick,\n  onMouseEnter,\n  className = '',\n  getActiveProps = () => ({}),\n  activeOptions,\n  preload,\n  disabled,\n  _ref,\n  ...rest\n}: LinkProps<TGenerics>) {\n  const loadRoute = useLoadRoute<TGenerics>()\n  const match = useMatch<TGenerics>()\n  const location = useLocation<TGenerics>()\n  const router = useRouter<TGenerics>()\n  const navigate = useNavigate<TGenerics>()\n  const buildNext = useBuildNext<TGenerics>()\n\n  preload = preload ?? router.defaultLinkPreloadMaxAge\n\n  // If this `to` is a valid external URL, log a warning\n  try {\n    const url = new URL(`${to}`)\n    warning(\n      false,\n      `<Link /> should not be used for external URLs like: ${url.href}`,\n    )\n  } catch (e) {}\n\n  const next = buildNext({\n    to,\n    search,\n    hash,\n    from: { pathname: match.pathname },\n  })\n\n  // The click handler\n  const handleClick = (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (onClick) onClick(e)\n\n    if (\n      !isCtrlEvent(e) &&\n      !e.defaultPrevented &&\n      (!target || target === '_self') &&\n      e.button === 0\n    ) {\n      e.preventDefault()\n      // All is well? Navigate!\n      navigate({\n        to,\n        search,\n        hash,\n        replace,\n        from: { pathname: match.pathname },\n      })\n    }\n  }\n\n  // The click handler\n  const handleMouseEnter = (e: React.MouseEvent<HTMLAnchorElement>) => {\n    if (onMouseEnter) onMouseEnter(e)\n\n    if (preload && preload > 0) {\n      loadRoute(\n        {\n          to,\n          search,\n          hash,\n        },\n        { maxAge: preload },\n      )\n    }\n  }\n\n  // Compare path/hash for matches\n  const pathIsEqual = location.current.pathname === next.pathname\n  const currentPathSplit = location.current.pathname.split('/')\n  const nextPathSplit = next.pathname.split('/')\n  const pathIsFuzzyEqual = nextPathSplit.every(\n    (d, i) => d === currentPathSplit[i],\n  )\n  const hashIsEqual = location.current.hash === next.hash\n\n  // Combine the matches based on user options\n  const pathTest = activeOptions?.exact ? pathIsEqual : pathIsFuzzyEqual\n  const hashTest = activeOptions?.includeHash ? hashIsEqual : true\n\n  // The final \"active\" test\n  const isActive = pathTest && hashTest\n\n  // Get the active props\n  const {\n    style: activeStyle = {},\n    className: activeClassName = '',\n    ...activeRest\n  } = isActive ? getActiveProps() : {}\n\n  return (\n    <a\n      {...{\n        ref: _ref,\n        href: disabled ? undefined : next.href,\n        onClick: handleClick,\n        onMouseEnter: handleMouseEnter,\n        target,\n        style: {\n          ...style,\n          ...activeStyle,\n        },\n        className:\n          [className, activeClassName].filter(Boolean).join(' ') || undefined,\n        ...(disabled\n          ? {\n              role: 'link',\n              'aria-disabled': true,\n            }\n          : undefined),\n        ...rest,\n        ...activeRest,\n        children:\n          typeof children === 'function' ? children({ isActive }) : children,\n      }}\n    />\n  )\n}\n\nexport function Outlet<TGenerics extends PartialGenerics = DefaultGenerics>() {\n  const router = useRouter<TGenerics>()\n  const [_, ...matches] = useMatches<TGenerics>()\n\n  const match = matches[0]\n\n  if (!match) {\n    return null\n  }\n\n  const errorElement = match.errorElement ?? router.defaultErrorElement\n\n  const element = (() => {\n    if (match.status === 'rejected') {\n      if (errorElement) {\n        return errorElement\n      }\n\n      if (!router.useErrorBoundary) {\n        if (process.env.NODE_ENV !== 'production') {\n          const preStyle: React.HTMLAttributes<HTMLPreElement>['style'] = {\n            whiteSpace: 'normal',\n            display: 'inline-block',\n            background: 'rgba(0,0,0,.1)',\n            padding: '.1rem .2rem',\n            margin: '.1rem',\n            lineHeight: '1',\n            borderRadius: '.25rem',\n          }\n\n          return (\n            <div style={{ lineHeight: '1.7' }}>\n              <strong>\n                The following error occured in the loader for you route at:{' '}\n                <pre style={preStyle}>{match.pathname}</pre>\n              </strong>\n              .\n              <br />\n              <pre\n                style={{\n                  ...preStyle,\n                  display: 'block',\n                  padding: '.5rem',\n                  borderRadius: '.5rem',\n                }}\n              >\n                {(match.error as any).toString()}\n              </pre>\n              <br />\n              Your users won't see this message in production, but they will see{' '}\n              <strong>\"An unknown error occured!\"</strong>, which is at least\n              better than breaking your entire app. 😊 For a better UX, please\n              specify an <pre style={preStyle}>errorElement</pre> for all of\n              your routes that contain asynchronous behavior, or at least\n              provide your own\n              <pre style={preStyle}>ErrorBoundary</pre> wrapper around your\n              renders to both the elements rendered by{' '}\n              <pre style={preStyle}>\n                {'useRoutes(routes, { useErrorBoundary: true })'}\n              </pre>{' '}\n              and <pre style={preStyle}>{'<Router useErrorBoundary />'}</pre>.{' '}\n              <br />\n              <br />\n            </div>\n          )\n        }\n        return 'An unknown error occured!'\n      }\n\n      throw match.error\n    }\n\n    const pendingElement = match.pendingElement ?? router.defaultPendingElement\n\n    if (match.status === 'pending') {\n      if (match.route.pendingMs || pendingElement) {\n        return pendingElement ?? null\n      }\n    }\n\n    const matchElement = match.element ?? router.defaultElement\n\n    return matchElement ? (\n      <React.Fragment>{matchElement}</React.Fragment>\n    ) : (\n      <Outlet<TGenerics> />\n    )\n  })()\n\n  return <MatchesProvider value={matches}>{element}</MatchesProvider>\n}\n\nexport function useResolvePath<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>() {\n  const router = useRouter<TGenerics>()\n  const match = useMatch<TGenerics>()\n\n  return useLatestCallback((path: string) =>\n    resolvePath(router.basepath!, match.pathname!, cleanPath(path)),\n  )\n}\n\nexport type UseSearchType<TGenerics extends PartialGenerics = DefaultGenerics> =\n  () => Partial<Maybe<TGenerics['Search'], Search<any>>>\n\nexport function useSearch<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>() {\n  const location = useLocation<TGenerics>()\n  return location.current.search\n}\n\nexport type MatchRouteType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = (\n  currentLocation: Location<TGenerics>,\n  matchLocation: MatchLocation<TGenerics>,\n) => UseGeneric<TGenerics, 'Params'> | undefined\n\nexport function matchRoute<TGenerics extends PartialGenerics = DefaultGenerics>(\n  currentLocation: Location<TGenerics>,\n  matchLocation: MatchLocation<TGenerics>,\n): UseGeneric<TGenerics, 'Params'> | undefined {\n  const pathParams = matchByPath(currentLocation, matchLocation)\n  const searchMatched = matchBySearch(currentLocation, matchLocation)\n\n  if (matchLocation.to && !pathParams) {\n    return\n  }\n\n  if (matchLocation.search && !searchMatched) {\n    return\n  }\n\n  return (pathParams ?? {}) as UseGeneric<TGenerics, 'Params'>\n}\n\nexport type UseMatchRouteType<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n> = () => (\n  matchLocation: MatchLocation<TGenerics>,\n) => Maybe<TGenerics['Params'], Params<any>> | undefined\n\nexport type UseMatchRouteOptions<TGenerics> = MatchLocation<TGenerics> & {\n  pending?: boolean\n}\n\nexport function useMatchRoute<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(): (\n  matchLocation: UseMatchRouteOptions<TGenerics>,\n) => Maybe<TGenerics['Params'], Params<any>> | undefined {\n  const router = useRouter<TGenerics>()\n  const resolvePath = useResolvePath<TGenerics>()\n\n  return useLatestCallback(\n    ({\n      pending,\n      ...matchLocation\n    }: MatchLocation<TGenerics> & { pending?: boolean }) => {\n      matchLocation = {\n        ...matchLocation,\n        to: matchLocation.to ? resolvePath(`${matchLocation.to}`) : undefined,\n      }\n\n      if (pending) {\n        if (!router.pending?.location) {\n          return undefined\n        }\n        return matchRoute(router.pending.location, matchLocation)\n      }\n\n      return matchRoute(router.state.location, matchLocation)\n    },\n  )\n}\n\nexport function MatchRoute<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>({\n  children,\n  ...rest\n}: UseMatchRouteOptions<TGenerics> & {\n  children:\n    | React.ReactNode\n    | ((isNextLocation?: Params<TGenerics>) => React.ReactNode)\n}) {\n  const matchRoute = useMatchRoute<TGenerics>()\n  const match = matchRoute(rest)\n\n  if (typeof children === 'function') {\n    return children(match as any)\n  }\n\n  return match ? children : null\n}\n\nexport function usePrompt(message: string, when: boolean | any): void {\n  const location = useLocation()\n\n  React.useEffect(() => {\n    if (!when) return\n\n    let unblock = location.history.block((transition) => {\n      if (window.confirm(message)) {\n        unblock()\n        transition.retry()\n      } else {\n        location.current.pathname = window.location.pathname\n      }\n    })\n\n    return unblock\n  }, [when, location, message])\n}\n\nexport function Prompt({ message, when, children }: PromptProps) {\n  usePrompt(message, when ?? true)\n  return children ?? null\n}\n\nfunction warning(cond: boolean, message: string) {\n  if (!cond) {\n    if (typeof console !== 'undefined') console.warn(message)\n\n    try {\n      throw new Error(message)\n    } catch {}\n  }\n}\n\nfunction isFunction(d: any): d is Function {\n  return typeof d === 'function'\n}\n\nexport function functionalUpdate<TResult>(\n  updater?: Updater<TResult>,\n  previous?: TResult,\n) {\n  if (isFunction(updater)) {\n    return updater(previous as TResult)\n  }\n\n  return updater\n}\n\nfunction joinPaths(paths: (string | undefined)[]) {\n  return cleanPath(paths.filter(Boolean).join('/'))\n}\n\nexport function cleanPath(path: string) {\n  // remove double slashes\n  return `${path}`.replace(/\\/{2,}/g, '/')\n}\n\nexport function matchByPath<\n  TGenerics extends PartialGenerics = DefaultGenerics,\n>(\n  currentLocation: Location<TGenerics>,\n  matchLocation: MatchLocation<TGenerics>,\n): UseGeneric<TGenerics, 'Params'> | undefined {\n  const baseSegments = parsePathname(currentLocation.pathname)\n  const routeSegments = parsePathname(`${matchLocation.to ?? '*'}`)\n\n  // console.log(baseSegments, routeSegments)\n\n  const params: Record<string, string> = {}\n\n  let isMatch = (() => {\n    for (\n      let i = 0;\n      i < Math.max(baseSegments.length, routeSegments.length);\n      i++\n    ) {\n      const baseSegment = baseSegments[i]\n      const routeSegment = routeSegments[i]\n\n      const isLastRouteSegment = i === routeSegments.length - 1\n      const isLastBaseSegment = i === baseSegments.length - 1\n\n      if (routeSegment) {\n        if (routeSegment.type === 'wildcard') {\n          if (baseSegment?.value) {\n            params['*'] = joinPaths(baseSegments.slice(i).map((d) => d.value))\n            return true\n          }\n          return false\n        }\n\n        if (routeSegment.type === 'pathname') {\n          if (routeSegment.value === '/' && !baseSegment?.value) {\n            return true\n          }\n\n          if (baseSegment) {\n            if (routeSegment.value !== baseSegment.value) {\n              return false\n            }\n          }\n        }\n\n        if (!baseSegment) {\n          return false\n        }\n\n        if (routeSegment.type === 'param') {\n          params[routeSegment.value.substring(1)] = baseSegment.value\n        }\n      }\n\n      if (isLastRouteSegment && !isLastBaseSegment) {\n        return !!matchLocation.fuzzy\n      }\n    }\n    return true\n  })()\n\n  return isMatch ? (params as UseGeneric<TGenerics, 'Params'>) : undefined\n}\n\nfunction matchBySearch<TGenerics extends PartialGenerics = DefaultGenerics>(\n  currentLocation: Location<TGenerics>,\n  matchLocation: MatchLocation<TGenerics>,\n) {\n  return !!(\n    matchLocation.search && matchLocation.search(currentLocation.search)\n  )\n}\n\nexport function parsePathname(pathname?: string): Segment[] {\n  if (!pathname) {\n    return []\n  }\n\n  pathname = cleanPath(pathname)\n\n  const segments: Segment[] = []\n\n  if (pathname.slice(0, 1) === '/') {\n    pathname = pathname.substring(1)\n    segments.push({\n      type: 'pathname',\n      value: '/',\n    })\n  }\n\n  if (!pathname) {\n    return segments\n  }\n\n  // Remove empty segments and '.' segments\n  const split = pathname.split('/').filter(Boolean)\n\n  segments.push(\n    ...split.map((part): Segment => {\n      if (part.startsWith('*')) {\n        return {\n          type: 'wildcard',\n          value: part,\n        }\n      }\n\n      if (part.charAt(0) === ':') {\n        return {\n          type: 'param',\n          value: part,\n        }\n      }\n\n      return {\n        type: 'pathname',\n        value: part,\n      }\n    }),\n  )\n\n  if (pathname.slice(-1) === '/') {\n    pathname = pathname.substring(1)\n    segments.push({\n      type: 'pathname',\n      value: '/',\n    })\n  }\n\n  return segments\n}\n\nfunction resolvePath(basepath: string, base: string, to: string) {\n  base = base.replace(new RegExp(`^${basepath}`), '/')\n  to = to.replace(new RegExp(`^${basepath}`), '/')\n\n  let baseSegments = parsePathname(base)\n  const toSegments = parsePathname(to)\n\n  toSegments.forEach((toSegment, index) => {\n    if (toSegment.value === '/') {\n      if (!index) {\n        baseSegments = [toSegment]\n      } else {\n        // ignore inter-slashes\n      }\n    } else if (toSegment.value === '..') {\n      baseSegments.pop()\n    } else if (toSegment.value === '.') {\n      return\n    } else {\n      baseSegments.push(toSegment)\n    }\n  })\n\n  const joined = joinPaths([basepath, ...baseSegments.map((d) => d.value)])\n\n  return cleanPath(joined)\n}\n\nfunction isCtrlEvent(e: React.MouseEvent) {\n  return !!(e.metaKey || e.altKey || e.ctrlKey || e.shiftKey)\n}\n\nfunction useLatestCallback<TCallback extends (...args: any[]) => any>(\n  cb: TCallback,\n) {\n  const stableFnRef =\n    React.useRef<(...args: Parameters<TCallback>) => ReturnType<TCallback>>()\n  const cbRef = React.useRef<TCallback>(cb)\n\n  cbRef.current = cb\n\n  if (!stableFnRef.current) {\n    stableFnRef.current = (...args) => cbRef.current(...args)\n  }\n\n  return stableFnRef.current\n}\n\nfunction useGetIsMounted() {\n  const ref = React.useRef(false)\n\n  React.useEffect(() => {\n    ref.current = true\n\n    return () => {\n      ref.current = false\n    }\n  })\n\n  return () => ref.current\n}\n\n/**\n * This function returns `a` if `b` is deeply equal.\n * If not, it will replace any deeply equal children of `b` with those of `a`.\n * This can be used for structural sharing between JSON values for example.\n */\nfunction replaceEqualDeep(prev: any, next: any) {\n  if (prev === next) {\n    return prev\n  }\n\n  const array = Array.isArray(prev) && Array.isArray(next)\n\n  if (array || (isPlainObject(prev) && isPlainObject(next))) {\n    const aSize = array ? prev.length : Object.keys(prev).length\n    const bItems = array ? next : Object.keys(next)\n    const bSize = bItems.length\n    const copy: any = array ? [] : {}\n\n    let equalItems = 0\n\n    for (let i = 0; i < bSize; i++) {\n      const key = array ? i : bItems[i]\n      copy[key] = replaceEqualDeep(prev[key], next[key])\n      if (copy[key] === prev[key]) {\n        equalItems++\n      }\n    }\n\n    return aSize === bSize && equalItems === aSize ? prev : copy\n  }\n\n  return next\n}\n\n// Copied from: https://github.com/jonschlinkert/is-plain-object\nfunction isPlainObject(o: any) {\n  if (!hasObjectPrototype(o)) {\n    return false\n  }\n\n  // If has modified constructor\n  const ctor = o.constructor\n  if (typeof ctor === 'undefined') {\n    return true\n  }\n\n  // If has modified prototype\n  const prot = ctor.prototype\n  if (!hasObjectPrototype(prot)) {\n    return false\n  }\n\n  // If constructor does not have an Object-specific method\n  if (!prot.hasOwnProperty('isPrototypeOf')) {\n    return false\n  }\n\n  // Most likely a plain Object\n  return true\n}\n\nfunction hasObjectPrototype(o: any) {\n  return Object.prototype.toString.call(o) === '[object Object]'\n}\n\nexport function defaultStringifySearch(search: Record<string, unknown>) {\n  search = { ...search }\n\n  if (search) {\n    Object.keys(search).forEach((key) => {\n      const val = search[key]\n      if (typeof val === 'undefined' || val === undefined) {\n        delete search[key]\n      } else if (val && typeof val === 'object' && val !== null) {\n        try {\n          search[key] = JSON.stringify(val)\n        } catch (err) {\n          // silent\n        }\n      }\n    })\n  }\n\n  const searchStr = new URLSearchParams(\n    search as Record<string, string>,\n  ).toString()\n\n  return searchStr ? `?${searchStr}` : ''\n}\n\nexport function defaultParseSearch(searchStr: string): Record<string, any> {\n  if (searchStr.substring(0, 1) === '?') {\n    searchStr = searchStr.substring(1)\n  }\n\n  let query: Record<string, unknown> = Object.fromEntries(\n    (new URLSearchParams(searchStr) as any).entries(),\n  )\n\n  // Try to parse query params\n  for (let key in query) {\n    const value = query[key]\n\n    try {\n      query[key] = JSON.parse(value as string)\n    } catch (err) {\n      //\n    }\n  }\n\n  return query\n}\n"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","LocationContext","React","createContext","MatchesContext","routerContext","isDOM","Boolean","window","document","createElement","useLayoutEffect","useEffect","createDefaultHistory","createBrowserHistory","createMemoryHistory","Subscribable","listeners","subscribe","listener","push","filter","x","notify","payload","forEach","ReactLocation","options","isTransitioning","history","stringifySearch","defaultStringifySearch","parseSearch","defaultParseSearch","current","parseLocation","location","destroy","listen","event","buildNext","basepath","dest","from","pathname","resolvePath","to","updatedSearch","search","functionalUpdate","filteredSearch","__searchFilters","reduce","prev","next","replaceEqualDeep","searchStr","hash","href","navigate","replace","navigateTimeout","clearTimeout","nextAction","setTimeout","isSameUrl","previousLocation","parsedSearch","split","reverse","MatchesProvider","props","Router","children","rest","routerRef","useRef","RouterInstance","router","useReducer","nonce","rerender","updateLocation","unsubscribe","routerValue","useMemo","rootMatch","state","matches","opts","setState","updater","newState","pending","cleanMatchCache","matchCache","getMatchLoader","MatchLoader","activeMatchIds","map","d","id","values","match","updatedAt","includes","age","Date","now","maxAge","promise","Promise","resolve","matchLoader","used","old","status","currentMatches","find","dd","onExit","route","onTransition","onMatch","undefined","loadData","startPending","cleanPath","params","routeIndex","data","isLoading","initialMatches","useLocation","getIsMounted","useGetIsMounted","instance","useContext","warning","then","renderAllLocationSubscribers","RouteMatch","unloadedMatch","isSoft","assignMatchLoader","pendingTimeout","pendingMs","pendingMinMs","pendingMinPromise","r","load","loaderMaxAge","defaultLoaderMaxAge","loaderPromise","importer","import","imported","elementPromises","elementTypes","type","routeElement","res","loader","dataPromise","resolveLoader","rejectLoader","error","reject","err","console","finish","parentMatch","dispatch","all","nextLocation","preNotify","index","loadMatches","unloadedMatches","matchRoutes","firstRenderPromises","useRouter","value","Error","currentLocation","routes","recurse","filteredRoutes","filterRoutes","originalRoute","fullRoutePathName","joinPaths","path","fuzzy","matchParams","matchRoute","interpolatedPathSegments","parsePathname","interpolatedPath","segment","substring","toString","defaultPendingMs","defaultPendingMinMs","useLoadRoute","useMatch","useBuildNext","useLatestCallback","useParentMatches","slice","findIndex","useMatches","useNavigate","fromCurrent","Navigate","searchFilters","flat","Link","style","onClick","onMouseEnter","className","getActiveProps","activeOptions","preload","disabled","_ref","loadRoute","defaultLinkPreloadMaxAge","url","URL","e","handleClick","isCtrlEvent","defaultPrevented","button","preventDefault","handleMouseEnter","pathIsEqual","currentPathSplit","nextPathSplit","pathIsFuzzyEqual","every","hashIsEqual","pathTest","exact","hashTest","includeHash","isActive","activeStyle","activeClassName","activeRest","ref","join","role","Outlet","errorElement","defaultErrorElement","element","useErrorBoundary","preStyle","whiteSpace","display","background","padding","margin","lineHeight","borderRadius","pendingElement","defaultPendingElement","matchElement","defaultElement","useResolvePath","useSearch","matchLocation","pathParams","matchByPath","searchMatched","matchBySearch","useMatchRoute","MatchRoute","usePrompt","message","when","unblock","block","transition","confirm","retry","Prompt","cond","warn","isFunction","previous","paths","baseSegments","routeSegments","isMatch","Math","max","baseSegment","routeSegment","isLastRouteSegment","isLastBaseSegment","segments","part","startsWith","charAt","base","RegExp","toSegments","toSegment","pop","joined","metaKey","altKey","ctrlKey","shiftKey","cb","stableFnRef","cbRef","array","Array","isArray","isPlainObject","aSize","keys","bItems","bSize","copy","equalItems","o","hasObjectPrototype","ctor","constructor","prot","val","JSON","stringify","URLSearchParams","query","fromEntries","entries","parse"],"mappings":"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"}